
<!DOCTYPE html>
<html>
  <head>
    <title>Solar Panel Placement</title>
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: -34.397, lng: 150.644},
          zoom: 8
        });
      }

      function placeMarkerAndPanTo(latLng, map) {
        var marker = new google.maps.Marker({
          position: latLng,
          map: map
        });
        map.panTo(latLng);

        getSolarData(latLng.lat(), latLng.lng())
          .then(data => {
            if (data.error) {
              alert('Solar data not found for this location');
            } else {
              displaySolarData(data);
            }
          });
      }

      async function getSolarData(lat, lng) {
        const response = await fetch(`/solar?lat=${lat}&lng=${lng}`);
        const data = await response.json();
        return data;
      }

      function displaySolarData(data) {
        document.getElementById('solarData').innerHTML = JSON.stringify(data, null, 2);
      }

      function getInputCoordinates() {
        const lat = document.getElementById('latitude').value;
        const lng = document.getElementById('longitude').value;
        placeMarkerAndPanTo(new google.maps.LatLng(lat, lng), map);
      }
    </script>
  </head>
  <body onload="initMap()">
    <div id="map" style="height: 500px; width: 100%;"></div>
    <input type="text" id="latitude" placeholder="Enter Latitude">
    <input type="text" id="longitude" placeholder="Enter Longitude">
    <button onclick="getInputCoordinates()">Submit</button>
    <pre id="solarData"></pre>

    <script>
      function loadMapScript() {
        const API_KEY =  process.env.API_KEY;
        const script = document.createElement('script');
        script.src = 'https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap';
        script.async = true;
        document.body.appendChild(script);
      }
      window.onload = loadMapScript;
    </script>
  </body>
</html>
